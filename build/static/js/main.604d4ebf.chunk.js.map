{"version":3,"sources":["constants.js","reducers/photoList.js","reducers/login.js","reducers/index.js","modules/List/LikeButton/index.js","modules/List/index.js","modules/List/LoadButton/index.js","modules/routes/Main/index.js","modules/routes/Details/index.js","modules/routes/Auth/index.js","modules/routes/RedirectPage/index.js","modules/App/index.js","actions/index.js","index.js"],"names":["isLocal","initState","list","page","isLoading","requestFailed","status","errorMessage","updateLikes","state","key","photo","newList","loadList","data","setErrorMessage","message","toggleIsLoading","photoList","action","type","isLoggedIn","Cookies","get","checkAuth","login","combineReducers","LikeButton","likePhoto","i","id","likes","likedByUser","onClick","List","props","loadData","bind","this","map","el","className","to","src","urls","thumb","alt","alt_description","liked_by_user","React","Component","LoadButton","Main","logOut","l","window","location","query","URLSearchParams","search","hash","replace","Details","useParams","Auth","authenticationUrl","RedirectPage","logIn","url","protocol","hostname","port","pathname","code","unsplash","auth","userAuthentication","then","res","ok","alert","errorHandler","toJson","catch","err","json","access_token","App","basename","exact","path","connect","dispatch","isLiked","a","photos","unlikePhoto","failed","listPhotos","accessToken","set","remove","Unsplash","accessKey","secret","callbackUrl","bearerToken","getAuthenticationUrl","store","createStore","reducer","composeWithDevTools","applyMiddleware","thunk","ReactDOM","render","document","querySelector"],"mappings":"gXAG8BA,E,gHCHxBC,EAAY,CAChBC,KAAM,GACNC,KAAM,EACNC,WAAW,EACXC,cAAe,CACbC,QAAQ,EACRC,aAAc,KAIZC,EAAc,SAACC,EAAD,EAAiBC,GAAS,IAAjBC,EAAgB,EAAhBA,MACrBC,EAAO,YAAOH,EAAMP,MAG1B,OAFAU,EAAQF,GAAOC,EAER,2BACFF,GADL,IAEEP,KAAMU,KAIJC,EAAW,SAACJ,EAAOK,GAAU,IAC5BZ,EAAcO,EAAdP,KAAMC,EAAQM,EAARN,KAGX,OAFAA,IAEO,2BACFM,GADL,IAEEN,KAAMA,EACND,KAAK,GAAD,mBACGA,GADH,YAEGY,IAEPV,WAAW,EACXC,cAAc,2BACTI,EAAMJ,eADE,IAEXC,QAAQ,OAKRS,EAAkB,SAACN,EAAOO,GAAR,mBAAC,eACpBP,GADmB,IAEtBL,WAAW,EACXC,cAAc,2BACTI,EAAMJ,eADE,IAEXC,QAAQ,EACRC,aAAcS,OAIZC,EAAkB,SAAAR,GACtB,OAAO,2BACFA,GADL,IAEEL,WAAW,EACXC,cAAc,2BACTI,EAAMJ,eADE,IAEXC,QAAQ,OAeCY,EAVG,WAAgC,IAA/BT,EAA8B,uDAAtBR,EAAWkB,EAAW,uCAC/C,OAAQA,EAAOC,MACb,IAAK,aAAc,OAAOZ,EAAYC,EAAOU,EAAOL,KAAMK,EAAOT,KACjE,IAAK,YAAa,OAAOG,EAASJ,EAAOU,EAAOL,MAChD,IAAK,aAAc,OAAOG,EAAgBR,GAC1C,IAAK,iBAAkB,OAAOM,EAAgBN,EAAOU,EAAOH,SAC5D,QAAS,OAAOP,IChEdR,EAAY,CAChBoB,aAAcC,IAAQC,IAAI,0BAGtBC,EAAY,SAAAf,GAAK,kCAClBA,GADkB,IAErBY,aAAcC,IAAQC,IAAI,4BAUbE,EAPD,WAAgC,IAA/BhB,EAA8B,uDAAtBR,EAAWkB,EAAW,uCAC3C,OAAQA,EAAOC,MACb,IAAK,aAAc,OAAOI,EAAUf,GACpC,QAAS,OAAOA,ICTLiB,4BAAgB,CAC7BD,QACAP,c,uFCEaS,G,MAPI,SAAC,GAAD,IAAEC,EAAF,EAAEA,UAAWC,EAAb,EAAaA,EAAGC,EAAhB,EAAgBA,GAAIC,EAApB,EAAoBA,MAAOC,EAA3B,EAA2BA,YAA3B,OACf,6BACE,4BAAQC,QAAS,kBAAML,EAAUE,EAAIE,EAAaH,MAClD,8BAAOE,MCoCEG,E,kDAnCb,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IACDC,SAAWD,EAAMC,SAASC,KAAf,gBAFC,E,gEAMZC,KAAKH,MAAMhC,MAAMmC,KAAKF,SAAS,K,+BAG5B,IAAD,OACP,OAAOE,KAAKH,MAAM9B,cAAcC,OAAS,qHAAqBgC,KAAKH,MAAM9B,cAAcE,cACnF,4BAEI+B,KAAKH,MAAMjC,KAAKqC,KAAI,SAACC,EAAIX,GAAL,OAEZ,wBAAInB,IAAKmB,EAAGY,UAAU,QACpB,kBAAC,IAAD,CAAMC,GAAE,iBAAYF,EAAGV,KACrB,yBAAKW,UAAU,MAAME,IAAKH,EAAGI,KAAKC,MAAOC,IAAKN,EAAGO,mBAEnD,kBAAC,EAAD,CACI1C,cAAe,EAAK8B,MAAM9B,cAC1BuB,UAAW,EAAKO,MAAMP,UACtBC,EAAGA,EACHC,GAAIU,EAAGV,GACPC,MAAOS,EAAGT,MACVC,YAAaQ,EAAGQ,yB,GA1BvBC,IAAMC,WCYVC,G,MAdI,SAAC,GAAD,IAAE/C,EAAF,EAAEA,UAAWD,EAAb,EAAaA,KAAMiC,EAAnB,EAAmBA,SAAnB,OAAiChC,EAChD,yBAAKqC,UAAU,gBAAf,uDAIA,4BACIA,UAAU,YACVR,QAAS,WACPG,EAASjC,KAHf,kFCwBWiD,EA1BF,SAAC,GAA0D,IAAzD/B,EAAwD,EAAxDA,WAAYH,EAA4C,EAA5CA,UAAWmC,EAAiC,EAAjCA,OAAQjB,EAAyB,EAAzBA,SAAUR,EAAe,EAAfA,UAChD0B,EAAIC,OAAOC,SACXC,EAAQ,IAAIC,gBAAgBJ,EAAEK,QAAQpC,IAAI,eAC1CqC,EAAON,EAAEM,KAERzD,EAAwCe,EAAxCf,KAAMC,EAAkCc,EAAlCd,UAAWC,EAAuBa,EAAvBb,cAAeH,EAAQgB,EAARhB,KAEvC,OAAOuD,EAAQ,kBAAC,IAAD,CAAUf,GAAIe,EAAMI,QAAQ,SAAU,KAAOD,IAAYvC,EACpE,yBAAKoB,UAAU,WACb,4BAAQR,QAAS,kBAAMoB,MAAvB,kCAGA,kBAAC,EAAD,CACInD,KAAMA,EACNG,cAAeA,EACfF,KAAMA,EACNiC,SAAUA,EACVR,UAAWA,IACf,kBAAC,EAAD,CACIxB,UAAWA,EACXD,KAAMA,EACNiC,SAAUA,KAdiE,kBAAC,IAAD,CAAUM,GAAG,WCLrFoB,EALC,WAAO,IACdhC,EAAMiC,cAANjC,GACP,OAAO,6BAAMA,ICQAkC,EATF,SAAC,GAAD,SAAE3C,WAA6B,kBAAC,IAAD,CAAUqB,GAAG,MACrD,6BACE,qUAGA,4BAAQT,QAAS,kBAAMsB,OAAOC,SAASK,QAAQI,KAA/C,oCCqBSC,EAzBM,SAAC,GAAa,IAAZC,EAAW,EAAXA,MACfb,EAAIC,OAAOC,SACXY,EAAMd,EAAEe,SAAW,KAAOf,EAAEgB,UAAYhB,EAAEiB,KAAO,IAAMjB,EAAEiB,KAAO,IAAMjB,EAAEkB,SAASX,QAAQ,YAAa,KACtGY,EAAO,IAAIf,gBAAgBJ,EAAEK,QAAQpC,IAAI,QAE/C,OAAKkD,GAELC,EAASC,KAAKC,mBAAmBH,GAAMI,MAAK,SAAAC,GAM1C,OALKA,EAAIC,KACPC,MAAM,yCAAD,OAAYC,EAAaH,EAAIxE,UAClCgD,EAAEO,QAAQO,IAGLc,iBAAOJ,GAAKK,OAAM,SAAAC,GACvBJ,MAAM,yCAAD,OAAYI,IACjB9B,EAAEO,QAAQO,MACTS,MAAK,SAAAQ,GACFA,EAAKC,cAAcnB,EAAMkB,EAAKC,cAClChC,EAAEO,QAAQO,SAIP,gIAjBW,kBAAC,IAAD,CAAU1B,GAAG,OCC7B6C,EAAM,gBAAE9E,EAAF,EAAEA,MAAOmB,EAAT,EAASA,UAAWQ,EAApB,EAAoBA,SAAU+B,EAA9B,EAA8BA,MAAOd,EAArC,EAAqCA,OAArC,OACN,kBAAC,IAAD,CAAQmC,SAAS,oBACf,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,cAChB,kBAAC,EAAD,OAEF,kBAAC,IAAD,CAAOD,OAAK,EAACC,KAAK,SAChB,kBAAC,EAAD,CAAMrE,WAAYZ,EAAMgB,MAAMJ,cAEhC,kBAAC,IAAD,CAAOoE,OAAK,EAACC,KAAK,aAChB,kBAAC,EAAD,CAAcvB,MAAOA,KAEvB,kBAAC,IAAD,CAAOsB,OAAK,EAACC,KAAK,KAChB,kBAAC,EAAD,CACIrE,WAAYZ,EAAMgB,MAAMJ,WACxBH,UAAWT,EAAMS,UACjBmC,OAAQA,EACRzB,UAAWA,EACXQ,SAAUA,QAkBTmD,EAZfA,EAAMI,aACF,SAAAlF,GAAK,MAAK,CACRA,MAAOA,MAET,SAAAmF,GAAQ,MAAK,CACXhE,UAAW,SAACE,EAAI+D,EAASnF,GAAd,OAAsBkF,ECUd,SAAC9D,EAAI+D,EAASnF,GAAd,8CAAsB,WAAekF,GAAf,iBAAAE,EAAA,6DACvC3E,EAAS0E,EAAUnB,EAASqB,OAAOC,YAActB,EAASqB,OAAOnE,UAD1B,SAG1BT,EAAOW,GAAI+C,MAAK,SAAAC,GACjC,OAAKA,EAAIC,GAKFG,iBAAOJ,GAAKK,OAAM,SAACC,GAAD,MAAU,CACjCa,QAAQ,EACRjF,QAASoE,MACPP,MAAK,SAAAQ,GAAI,OAAIA,KARG,CAClBY,QAAQ,EACRjF,QAASiE,EAAaH,EAAIxE,YANe,QAGvCQ,EAHuC,QAepCmF,OACPL,EAAS,CACPxE,KAAM,iBACNJ,QAASF,EAAKE,UAGhB4E,EAAS,CACPxE,KAAM,aACNN,KAAMA,EACNJ,IAAKA,IAxBoC,2CAAtB,sDDVuBkB,CAAUE,EAAI+D,EAASnF,KACjE0B,SAAU,SAAAP,GAAC,OAAI+D,ECrBG,SAAA/D,GAAC,8CAAI,WAAe+D,GAAf,eAAAE,EAAA,6DAC3BF,EAAS,CACPxE,KAAM,eAFmB,SAKRsD,EAASqB,OAAOG,WAAWrE,EAAG,GAAI,UAAUgD,MAAK,SAAAC,GAClE,OAAKA,EAAIC,GAKFG,iBAAOJ,GAAKK,OAAM,SAACC,GAAD,MAAU,CACjCa,QAAQ,EACRjF,QAASoE,MACPP,MAAK,SAAAQ,GAAI,OAAIA,KARG,CAClBY,QAAQ,EACRjF,QAASiE,EAAaH,EAAIxE,YARH,QAKrBQ,EALqB,QAiBlBmF,OACPL,EAAS,CACPxE,KAAM,iBACNJ,QAASF,EAAKE,UAGhB4E,EAAS,CACPxE,KAAM,YACNN,KAAMA,IAzBiB,2CAAJ,sDDqBKsB,CAASP,KACjCsC,MAAO,SAAAgC,GAAW,OAAIP,ECtCP,SAAAO,GAGnB,OAFA7E,IAAQ8E,IAAI,wBAAyBD,GAE9B,CACL/E,KAAM,cDkC2B+C,CAAMgC,KACrC9C,OAAQ,kBAAMuC,GC9BlBtE,IAAQ+E,OAAO,yBAER,CACLjF,KAAM,oBDmBJuE,CAUJJ,GE7BWb,G,MAAW,IAAI4B,IAAS,CACnCC,UbjBwB,8CakBxBC,ObjBwB,8CakBxBC,abhB4BzG,GaWb,EbXwBA,EACnC,yDACA,uDaeJ0G,YAAapF,IAAQC,IAAI,4BAGd0C,EAAoBS,EAASC,KAAKgC,qBAAqB,CAClE,SACA,YACA,aACA,cACA,eACA,gBAGW1B,EAAe,SAAAR,GAC1B,OAAQA,GACN,KAAK,IAAK,MAAO,6KACjB,KAAK,IAAK,MAAO,oSACjB,KAAK,IAAK,MAAO,qLACjB,KAAK,IAAK,MAAO,qGACjB,QAAS,MAAM,gIAAN,OAAmCA,KAI1CmC,EAAQC,sBAAYC,EAASC,8BAAoBC,0BAAgBC,OAEvEC,IAASC,OACL,kBAAC,IAAD,CAAUP,MAAOA,GACf,kBAAC,EAAD,OAEFQ,SAASC,cAAc,Y","file":"static/js/main.604d4ebf.chunk.js","sourcesContent":["export const ACCESS_KEY = \"ANOEv2G8HQvmAGeNpKS1ERxGz7-1G5f91mH8sNyo4nk\";\r\nexport const SECRET_KEY = \"t42Xnafrq9i6jjvGmCt82qTAJ1PLW2DXQ74FOUElgAg\";\r\n\r\nexport const setRedirectUrl = isLocal => isLocal\r\n    ? \"http://superclaw.ddns.net:3000/phoiewer/build/redirect\"\r\n    : \"https://superclaw.github.io/phoiewer/build/redirect\";","const initState = {\r\n  list: [],\r\n  page: 0,\r\n  isLoading: false,\r\n  requestFailed: {\r\n    status: false,\r\n    errorMessage: '',\r\n  },\r\n};\r\n\r\nconst updateLikes = (state, {photo}, key) => {\r\n  const newList = [...state.list];\r\n  newList[key] = photo;\r\n\r\n  return {\r\n    ...state,\r\n    list: newList,\r\n  };\r\n}\r\n\r\nconst loadList = (state, data) => {\r\n  let {list, page} = state;\r\n  page++;\r\n\r\n  return {\r\n    ...state,\r\n    page: page,\r\n    list: [\r\n        ...list,\r\n        ...data,\r\n    ],\r\n    isLoading: false,\r\n    requestFailed: {\r\n      ...state.requestFailed,\r\n      status: false,\r\n    },\r\n  };\r\n};\r\n\r\nconst setErrorMessage = (state, message) => ({\r\n  ...state,\r\n  isLoading: false,\r\n  requestFailed: {\r\n    ...state.requestFailed,\r\n    status: true,\r\n    errorMessage: message,\r\n  },\r\n});\r\n\r\nconst toggleIsLoading = state => {\r\n  return {\r\n    ...state,\r\n    isLoading: true,\r\n    requestFailed: {\r\n      ...state.requestFailed,\r\n      status: false,\r\n    },\r\n  };\r\n};\r\n\r\nconst photoList = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case 'LIKE_PHOTO': return updateLikes(state, action.data, action.key);\r\n    case 'LOAD_NEXT': return loadList(state, action.data);\r\n    case 'IS_LOADING': return toggleIsLoading(state);\r\n    case 'REQUEST_FAILED': return setErrorMessage(state, action.message);\r\n    default: return state;\r\n  }\r\n};\r\n\r\nexport default photoList;","import Cookies from \"js-cookie\";\r\n\r\nconst initState = {\r\n  isLoggedIn: !!Cookies.get('unsplash_access_token'),\r\n};\r\n\r\nconst checkAuth = state => ({\r\n  ...state,\r\n  isLoggedIn: !!Cookies.get('unsplash_access_token'),\r\n});\r\n\r\nconst login = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case 'CHECK_AUTH': return checkAuth(state);\r\n    default: return state;\r\n  }\r\n}\r\n\r\nexport default login;","import {combineReducers} from \"redux\";\r\n\r\nimport photoList from \"./photoList\";\r\nimport login from \"./login\";\r\n\r\nexport default combineReducers({\r\n  login,\r\n  photoList,\r\n});","import React from \"react\";\r\n\r\nconst LikeButton = ({likePhoto, i, id, likes, likedByUser}) => (\r\n    <div>\r\n      <button onClick={() => likePhoto(id, likedByUser, i)}/>\r\n      <span>{likes}</span>\r\n    </div>\r\n);\r\n\r\nexport default LikeButton;","import React from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport \"./index.css\";\r\nimport LikeButton from \"./LikeButton\";\r\n\r\nclass List extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.loadData = props.loadData.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (!this.props.page) this.loadData(1);\r\n  }\r\n\r\n  render() {\r\n    return this.props.requestFailed.status ? <p>Ошибка загрузки: {this.props.requestFailed.errorMessage}</p> : (\r\n        <ul>\r\n          {\r\n            this.props.list.map((el, i) =>\r\n                (\r\n                    <li key={i} className=\"item\">\r\n                      <Link to={`/photo-${el.id}`}>\r\n                        <img className=\"img\" src={el.urls.thumb} alt={el.alt_description}/>\r\n                      </Link>\r\n                      <LikeButton\r\n                          requestFailed={this.props.requestFailed}\r\n                          likePhoto={this.props.likePhoto}\r\n                          i={i}\r\n                          id={el.id}\r\n                          likes={el.likes}\r\n                          likedByUser={el.liked_by_user} />\r\n                    </li>\r\n                )\r\n            )\r\n          }\r\n        </ul>\r\n    )\r\n  }\r\n}\r\n\r\nexport default List;","import React from \"react\";\r\nimport \"./index.css\";\r\n\r\nconst LoadButton = ({isLoading, page, loadData}) => isLoading ? (\r\n    <div className=\"loading-icon\">\r\n      Загрузка...\r\n    </div>\r\n) : (\r\n    <button\r\n        className=\"load-next\"\r\n        onClick={() => {\r\n          loadData(page);\r\n        }}>\r\n      Загрузить ещё...\r\n    </button>\r\n);\r\n\r\nexport default LoadButton;","import React from \"react\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\nimport List from \"../../List\";\r\nimport LoadButton from \"../../List/LoadButton\";\r\n\r\nconst Main = ({isLoggedIn, photoList, logOut, loadData, likePhoto}) => {\r\n  const l = window.location;\r\n  const query = new URLSearchParams(l.search).get('redirect_to');\r\n  const hash = l.hash;\r\n\r\n  const {page, isLoading, requestFailed, list} = photoList;\r\n\r\n  return query ? <Redirect to={query.replace(/~and~/g, '&') + hash} /> : !isLoggedIn ? <Redirect to=\"/auth\" /> : (\r\n      <div className=\"wrapper\">\r\n        <button onClick={() => logOut()}>\r\n          Выйти\r\n        </button>\r\n        <List\r\n            list={list}\r\n            requestFailed={requestFailed}\r\n            page={page}\r\n            loadData={loadData}\r\n            likePhoto={likePhoto} />\r\n        <LoadButton\r\n            isLoading={isLoading}\r\n            page={page}\r\n            loadData={loadData} />\r\n      </div>\r\n  );\r\n};\r\n\r\nexport default Main;","import React from \"react\";\r\nimport {useParams} from \"react-router-dom\";\r\n\r\nconst Details = () => {\r\n  const {id} = useParams();\r\n  return <div>{id}</div>\r\n};\r\n\r\nexport default Details;","import React from \"react\";\r\nimport {Redirect} from \"react-router-dom\";\r\nimport {authenticationUrl} from \"../../../index\";\r\n\r\nconst Auth = ({isLoggedIn}) => isLoggedIn ? <Redirect to=\"/\"/> : (\r\n    <div>\r\n      <p>\r\n        Для просмотра этой страницы необходимо авторизоваться.\r\n      </p>\r\n      <button onClick={() => window.location.replace(authenticationUrl)}>Войти</button>\r\n    </div>\r\n);\r\n\r\nexport default Auth;","import React from \"react\";\r\nimport {unsplash, errorHandler} from \"../../../index\";\r\nimport {toJson} from \"unsplash-js/lib/unsplash\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\nconst RedirectPage = ({logIn}) => {\r\n  const l = window.location;\r\n  const url = l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') + l.pathname.replace('/redirect', '/');\r\n  const code = new URLSearchParams(l.search).get('code');\r\n\r\n  if (!code) return <Redirect to=\"/\" />;\r\n\r\n  unsplash.auth.userAuthentication(code).then(res => {\r\n    if (!res.ok) {\r\n      alert(`Ошибка: ${errorHandler(res.status)}`);\r\n      l.replace(url);\r\n    }\r\n\r\n    return toJson(res).catch(err => {\r\n      alert(`Ошибка: ${err}`);\r\n      l.replace(url);\r\n    }).then(json => {\r\n      if (json.access_token) logIn(json.access_token);\r\n      l.replace(url);\r\n    });\r\n  });\r\n\r\n  return <div>Идёт авторизация...</div>;\r\n};\r\n\r\nexport default RedirectPage;","import React from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {BrowserRouter as Router, Switch, Route} from \"react-router-dom\";\r\nimport {likePhoto, loadData, logIn, logOut} from \"../../actions\";\r\nimport \"./index.css\";\r\n\r\nimport Main from \"../routes/Main\";\r\nimport Details from \"../routes/Details\";\r\nimport Auth from \"../routes/Auth\";\r\nimport RedirectPage from \"../routes/RedirectPage\";\r\n\r\nlet App = ({state, likePhoto, loadData, logIn, logOut}) => (\r\n    <Router basename=\"/phoiewer/build/\">\r\n      <Switch>\r\n        <Route exact path=\"/photo-:id\">\r\n          <Details />\r\n        </Route>\r\n        <Route exact path=\"/auth\">\r\n          <Auth isLoggedIn={state.login.isLoggedIn} />\r\n        </Route>\r\n        <Route exact path=\"/redirect\">\r\n          <RedirectPage logIn={logIn} />\r\n        </Route>\r\n        <Route exact path=\"/\">\r\n          <Main\r\n              isLoggedIn={state.login.isLoggedIn}\r\n              photoList={state.photoList}\r\n              logOut={logOut}\r\n              likePhoto={likePhoto}\r\n              loadData={loadData} />\r\n        </Route>\r\n      </Switch>\r\n    </Router>\r\n);\r\n\r\nApp = connect(\r\n    state => ({\r\n      state: state,\r\n    }),\r\n    dispatch => ({\r\n      likePhoto: (id, isLiked, key) => dispatch(likePhoto(id, isLiked, key)),\r\n      loadData: i => dispatch(loadData(i)),\r\n      logIn: accessToken => dispatch(logIn(accessToken)),\r\n      logOut: () => dispatch(logOut()),\r\n    }),\r\n)(App);\r\n\r\nexport default App;","import {unsplash, errorHandler} from \"../index\";\r\nimport {toJson} from \"unsplash-js/lib/unsplash\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nexport const logIn = accessToken => {\r\n  Cookies.set('unsplash_access_token', accessToken);\r\n\r\n  return {\r\n    type: 'CHECK_AUTH',\r\n  };\r\n};\r\n\r\nexport const logOut = () => {\r\n  Cookies.remove('unsplash_access_token');\r\n\r\n  return {\r\n    type: 'CHECK_AUTH',\r\n  };\r\n};\r\n\r\nexport const loadData = i => async function(dispatch) {\r\n  dispatch({\r\n    type: 'IS_LOADING',\r\n  });\r\n\r\n  const data = await unsplash.photos.listPhotos(i, 15, \"latest\").then(res => {\r\n    if (!res.ok) return {\r\n      failed: true,\r\n      message: errorHandler(res.status),\r\n    }\r\n\r\n    return toJson(res).catch((err) => ({\r\n      failed: true,\r\n      message: err,\r\n    })).then(json => json);\r\n  });\r\n\r\n  if (data.failed) {\r\n    dispatch({\r\n      type: 'REQUEST_FAILED',\r\n      message: data.message,\r\n    });\r\n  } else {\r\n    dispatch({\r\n      type: 'LOAD_NEXT',\r\n      data: data,\r\n    });\r\n  }\r\n};\r\n\r\nexport const likePhoto = (id, isLiked, key) => async function(dispatch) {\r\n  const action = isLiked ? unsplash.photos.unlikePhoto : unsplash.photos.likePhoto;\r\n\r\n  const data = await action(id).then(res => {\r\n    if (!res.ok) return {\r\n      failed: true,\r\n      message: errorHandler(res.status),\r\n    }\r\n\r\n    return toJson(res).catch((err) => ({\r\n      failed: true,\r\n      message: err,\r\n    })).then(json => json);\r\n  });\r\n\r\n  if (data.failed) {\r\n    dispatch({\r\n      type: 'REQUEST_FAILED',\r\n      message: data.message,\r\n    });\r\n  } else {\r\n    dispatch({\r\n      type: 'LIKE_PHOTO',\r\n      data: data,\r\n      key: key,\r\n    });\r\n  }\r\n}","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport {createStore, applyMiddleware} from \"redux\";\r\nimport {Provider} from \"react-redux\";\r\nimport {composeWithDevTools} from \"redux-devtools-extension\";\r\nimport thunk from \"redux-thunk\";\r\nimport Unsplash from \"unsplash-js/lib/unsplash\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nimport reducer from \"./reducers\";\r\nimport App from \"./modules/App\";\r\nimport {ACCESS_KEY, SECRET_KEY, setRedirectUrl} from \"./constants\";\r\nimport \"./index.css\";\r\n\r\nconst IS_LOCAL = false;\r\n\r\nexport const unsplash = new Unsplash({\r\n  accessKey: ACCESS_KEY,\r\n  secret: SECRET_KEY,\r\n  callbackUrl: setRedirectUrl(IS_LOCAL),\r\n  bearerToken: Cookies.get('unsplash_access_token'),\r\n});\r\n\r\nexport const authenticationUrl = unsplash.auth.getAuthenticationUrl([\r\n  \"public\",\r\n  \"read_user\",\r\n  \"write_user\",\r\n  \"read_photos\",\r\n  \"write_photos\",\r\n  \"write_likes\",\r\n]);\r\n\r\nexport const errorHandler = code => {\r\n  switch (code) {\r\n    case 400: return 'Код авторизации недействителен';\r\n    case 401: return 'Вы не авторизованы или срок действия авторизации истёк';\r\n    case 403: return 'Превышен лимит запросов на сервер';\r\n    case 404: return 'Данные не получены';\r\n    default: return `Неизвестная ошибка, код: ${code}`;\r\n  }\r\n};\r\n\r\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(thunk)));\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>,\r\n    document.querySelector('.main')\r\n);"],"sourceRoot":""}